---
title: "R Notebook"
output: html_notebook
---
# Experiment 2

```{r}
maxLag<-round(0.1*200)
option0<-0
```

```{r}
library(rmatio)
library(VLTimeCausality)
matTarget<-read.mat("data/multipleSimData/MPAtargetMat.mat")
matTarget<-t(matTarget$MPAtargetMat)
r1<-c()
p1<-c()
f1<-c()
count1<-0
for(i in seq(100))
{
filename<-sprintf("data/multipleSimData/SimTrajectoryDir-NORMAL-%d.mat",i)
out<-read.mat(filename)

TS<-t(out$TS)
option=option0

if(option==0)
{
  B<-multipleVLGrangerFunc(TS=TS,gamma=0.30,causalFlag=0,sigma = 0.5,maxLag=maxLag,VLflag=TRUE,autoLagflag=TRUE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}
else if(option==1)
{
  B<-multipleVLTransferEntropy(TS=TS,maxLag=maxLag,VLflag=FALSE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}
else if(option==2)
{
  B<-multipleVLTransferEntropy(TS=TS,maxLag=maxLag,VLflag=TRUE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}

}
#print(B)
print(sprintf("p%f,r%f,f%f",mean(p1),mean(r1),mean(f1)) )

```
ARMA
```{r}
library(rmatio)
library(VLTimeCausality)
matTarget<-read.mat("data/multipleSimData/MPAtargetMat.mat")
matTarget<-t(matTarget$MPAtargetMat)
r1<-c()
p1<-c()
f1<-c()
for(i in seq(100))
{
filename<-sprintf("data/multipleSimData/SimTrajectoryDir-ARMA-%d.mat",i)
out<-read.mat(filename)

TS<-t(out$TS)
option=option0

if(option==0)
{
  B<-multipleVLGrangerFunc(TS=TS,gamma=0.30,causalFlag=0,sigma = 0.5,maxLag=maxLag,VLflag=TRUE,autoLagflag=TRUE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}
else if(option==1)
{
  B<-multipleVLTransferEntropy(TS=TS,maxLag=maxLag,VLflag=FALSE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}
else if(option==2)
{
  B<-multipleVLTransferEntropy(TS=TS,maxLag=maxLag,VLflag=TRUE)
  res<-checkMultipleSimulationVLtimeseries(trueAdjMat=matTarget,B$adjMat)
  prec=res$prec
  rec=res$rec
  F1=res$F1
  print(sprintf("i%d,p%f,r%f,f%f",i,prec,rec,F1) )
  r1<-c(r1,rec)
  p1<-c(p1,prec)
  f1<-c(f1,F1)
}

}
#print(B)
print(sprintf("p%f,r%f,f%f",mean(p1),mean(r1),mean(f1)) )

```
#Experiment3

```{r}
maxLag<-round(0.1*200)
option0<-2
```


```{r}
library(rmatio)
library(VLTimeCausality)

count1<-0
for(i in seq(100))
{
filename<-sprintf("data/multipleSimData/SimTrajectoryDir-NORMAL-%d.mat",i)
out<-read.mat(filename)

TS<-t(out$TS)
option=option0
flag<-FALSE
if(option==0)
{
  Y<-rowMeans(TS[,4:10])
  X<-rowMeans(TS[,1:3])
  A<-VLGrangerFunc(Y=Y,X=X,gamma=0.50,maxLag=maxLag)
  flag<-A$XgCsY
  print(sprintf("i%d,ratio%f",i,A$BICDiffRatio) )
}
else if(option==1)
{
  A<-VLTransferEntropy(Y=Y,X=X,maxLag=maxLag,lx=maxLag,ly=maxLag)
  flag<-A$XgCsY_trns
  print(sprintf("i%d,TFratio%f",i,A$TEratio) )
}
else if(option==2)
{
  A<-VLTransferEntropy(Y=Y,X=X,VLflag=TRUE,maxLag=maxLag,lx=maxLag,ly=maxLag)
  flag<-A$XgCsY_trns
  print(sprintf("i%d,TFratio%f",i,A$TEratio) )
}
count1<-count1+as.integer(flag)
}
print(sprintf("count%d",count1) )
```

```{r}
count1<-0
for(i in seq(100))
{
filename<-sprintf("data/multipleSimData/SimTrajectoryDir-ARMA-%d.mat",i)
out<-read.mat(filename)

TS<-t(out$TS)
option=option0
flag<-FALSE
if(option==0)
{
  Y<-rowMeans(TS[,4:10])
  X<-rowMeans(TS[,1:3])
  A<-VLGrangerFunc(Y=Y,X=X,gamma=0.50,maxLag=maxLag)
  flag<-A$XgCsY
  print(sprintf("i%d,ratio%f",i,A$BICDiffRatio) )
}
else if(option==1)
{
  A<-VLTransferEntropy(Y=Y,X=X,maxLag=maxLag,lx=maxLag,ly=maxLag)
  flag<-A$XgCsY_trns
  print(sprintf("i%d,TFratio%f",i,B$TEratio) )
}
else if(option==2)
{
  A<-VLTransferEntropy(Y=Y,X=X,VLflag=TRUE,maxLag=maxLag,lx=maxLag,ly=maxLag)
  flag<-A$XgCsY_trns
  print(sprintf("i%d,TFratio%f",i,A$TEratio) )
}
count1<-count1+as.integer(flag)
}
print(sprintf("count%d",count1) )
```

